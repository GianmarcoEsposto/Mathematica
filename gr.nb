(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40686,       1034]
NotebookOptionsPosition[     39681,       1012]
NotebookOutlinePosition[     40150,       1030]
CellTagsIndexPosition[     40107,       1027]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"coord", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metric", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Alpha]", "[", "r", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"\[Beta]", "[", "r", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"r", "^", "2"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"r", "^", "2"}]}], " ", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "^", "2"}]}]}], "}"}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  "\"\<C:\\\\Users\\\\Gianmarco\\\\Downloads\\\\diffgeo.m\>\"", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9252030051290264`*^9, 3.925203036987861*^9}, {
  3.925203076717106*^9, 3.925203102042948*^9}, {3.925203211102993*^9, 
  3.925203258704605*^9}, {3.925203294284477*^9, 3.92520335343584*^9}, {
  3.92520341053342*^9, 3.925203421834038*^9}, {3.925203493092813*^9, 
  3.9252035204020386`*^9}, {3.925203789889454*^9, 3.925203799278726*^9}, {
  3.9252223438664207`*^9, 3.925222345065885*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"663eb267-6783-4340-88fa-a9de4ef266e3"],

Cell[BoxData[{
 RowBox[{"Einstein", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dsol", "=", 
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Einstein", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", "0"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"Einstein", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "==", "0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Alpha]", "[", "r", "]"}], ",", 
       RowBox[{"\[Beta]", "[", "r", "]"}]}], "}"}], ",", "r"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Einstein", " ", "/.", 
      RowBox[{"D", "[", 
       RowBox[{"dsol", ",", "r"}], "]"}]}], " ", "/.", " ", 
     RowBox[{"D", "[", 
      RowBox[{"dsol", ",", 
       RowBox[{"{", 
        RowBox[{"r", ",", "2"}], "}"}]}], "]"}]}], " ", "/.", "dsol"}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"metricschw", "=", 
   RowBox[{"ArrayReshape", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"metric", "/.", "dsol"}], "/.", " ", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"C", "[", "1", "]"}], "]"}], "->", 
        RowBox[{"-", "R"}]}]}], " ", "/.", " ", 
      RowBox[{
       RowBox[{"C", "[", "2", "]"}], "->", " ", "1"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"t", "'"}], "[", "s", "]"}], ",", 
         RowBox[{
          RowBox[{"r", "'"}], "[", "s", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "'"}], "[", "s", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "'"}], "[", "s", "]"}]}], "}"}], " ", ".", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"metricschw", "/.", 
            RowBox[{"r", "->", 
             RowBox[{"r", "[", "s", "]"}]}]}], "/.", 
           RowBox[{"\[Theta]", "->", 
            RowBox[{"\[Theta]", "[", "s", "]"}]}]}], "/.", 
          RowBox[{"\[Phi]", "->", 
           RowBox[{"\[Phi]", "[", "s", "]"}]}]}], "/.", 
         RowBox[{"R", "->", 
          FractionBox["1", "200"]}]}], ")"}]}], ")"}], ".", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"t", "'"}], "[", "s", "]"}], ",", 
       RowBox[{
        RowBox[{"r", "'"}], "[", "s", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "s", "]"}], ",", 
       RowBox[{
        RowBox[{"\[Phi]", "'"}], "[", "s", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"masslesscondeq", "=", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"L", "^", "2"}], "==", "0"}], ",", 
       RowBox[{
        RowBox[{"t", "'"}], "[", "s", "]"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Lagrangeeqs", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"L", "^", "2"}], ",", 
             RowBox[{
              RowBox[{"v", "'"}], "[", "s", "]"}]}], "]"}], ",", "s"}], "]"}],
          "-", " ", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"L", "^", "2"}], ",", 
           RowBox[{"v", "[", "s", "]"}]}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"v", ",", 
          RowBox[{"{", 
           RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], "}"}]}], 
       "]"}], "/.", " ", 
      RowBox[{"D", "[", 
       RowBox[{"masslesscondeq", ",", "s"}], "]"}]}], "/.", " ", 
     "masslesscondeq"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eq1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Lagrangeeqs", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "/.", " ", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "s", "]"}], " ", "->", 
        FractionBox["\[Pi]", "2"]}]}], " ", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "s", "]"}], " ", "->", "0"}]}], " ", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], " ", "->", "0"}]}], " ", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eq2", " ", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Lagrangeeqs", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "/.", " ", 
       RowBox[{
        RowBox[{"\[Theta]", "[", "s", "]"}], " ", "->", 
        FractionBox["\[Pi]", "2"]}]}], " ", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "s", "]"}], " ", "->", "0"}]}], " ", "/.", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Theta]", "''"}], "[", "s", "]"}], " ", "->", "0"}]}], " ", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"geodesics", "[", 
    RowBox[{"a_", "?", "NumericQ"}], "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"eq1", "==", "0"}], " ", "&&", 
         RowBox[{"eq2", "==", "0"}]}], " ", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "[", "0", "]"}], "==", " ", "D"}], ",", 
          RowBox[{
           RowBox[{"\[Phi]", "[", "0", "]"}], "==", 
           FractionBox["a", "D"]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "'"}], "[", "0", "]"}], "==", 
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["\[PartialD]", "D"], "D"}]}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Phi]", "'"}], "[", "0", "]"}], "==", 
           RowBox[{"-", 
            RowBox[{
             SubscriptBox["\[PartialD]", "D"], 
             FractionBox["a", "D"]}]}]}]}], "}"}]}], "}"}], "/.", 
      RowBox[{"D", "->", "10"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "s", "]"}], ",", 
       RowBox[{"\[Phi]", "[", "s", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "30"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fix", "=", 
   RowBox[{
    RowBox[{"InterpolatingFunction", "[", 
     RowBox[{"a_", ",", "b___"}], "]"}], ":>", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"s", ">", 
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "0", ",", 
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rsol", "[", "s_", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", "s", "]"}], "/.", 
        RowBox[{
         RowBox[{"geodesics", "[", 
          RowBox[{"i", "/", "40"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", "fix"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "50", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]sol", "[", "s_", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "s", "]"}], "/.", 
        RowBox[{
         RowBox[{"geodesics", "[", 
          RowBox[{"i", "/", "40"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", "fix"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "50", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y", "[", "s_", "]"}], "=", 
   RowBox[{
    RowBox[{"rsol", "[", "s", "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]sol", "[", "s", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x", "[", "s_", "]"}], "=", 
    RowBox[{
     RowBox[{"rsol", "[", "s", "]"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]sol", "[", "s", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "s", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"y", "[", "s", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "30"}], "}"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
           RowBox[{"{", "Purple", "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "->", "\"\<Geodesic trajectory\>\""}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "50", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"p", ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        FractionBox["1", "200"]}], "]"}]}], "}"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.9252048707128906`*^9, 3.925205014657875*^9}, {
   3.9252055517334595`*^9, 3.9252055573605785`*^9}, {3.9252056574993916`*^9, 
   3.925205706137745*^9}, {3.925205885627765*^9, 3.9252059109094925`*^9}, {
   3.925205953481191*^9, 3.925205965107105*^9}, {3.9252060160874615`*^9, 
   3.925206023796232*^9}, {3.925206060945473*^9, 3.925206083443632*^9}, {
   3.925206318845745*^9, 3.925206318952982*^9}, {3.925206640056309*^9, 
   3.9252067809367275`*^9}, {3.925206998102146*^9, 3.92520704143628*^9}, 
   3.925207072049829*^9, {3.925207182511793*^9, 3.925207184980528*^9}, {
   3.925207259738474*^9, 3.925207291961743*^9}, {3.925207347805691*^9, 
   3.9252073503752823`*^9}, {3.925207406711117*^9, 3.9252074373215427`*^9}, {
   3.9252074755824184`*^9, 3.925207631529825*^9}, {3.925208017671278*^9, 
   3.9252080979965134`*^9}, {3.925208151828319*^9, 3.925208227345873*^9}, {
   3.9252082620117474`*^9, 3.925208284524709*^9}, {3.925208335738901*^9, 
   3.9252083586905594`*^9}, 3.925208444283808*^9, {3.925208489066603*^9, 
   3.925208493687702*^9}, {3.925213302669021*^9, 3.9252134404039593`*^9}, {
   3.9252134708778553`*^9, 3.92521347726758*^9}, {3.925213533772419*^9, 
   3.925213629490204*^9}, {3.925213706250988*^9, 3.925213860116104*^9}, {
   3.925213943146944*^9, 3.92521401323658*^9}, {3.9252140646328945`*^9, 
   3.925214064732277*^9}, {3.925214106034868*^9, 3.9252141883728695`*^9}, {
   3.92521450756645*^9, 3.925214552188275*^9}, {3.925214646385601*^9, 
   3.9252146523467655`*^9}, {3.925214690901724*^9, 3.925214696821364*^9}, {
   3.925215091299808*^9, 3.925215111922109*^9}, {3.925215190924301*^9, 
   3.925215268384341*^9}, {3.925215307702036*^9, 3.925215313756588*^9}, {
   3.9252153622256584`*^9, 3.925215367960655*^9}, {3.9252154380166397`*^9, 
   3.925215494986055*^9}, {3.9252156153622303`*^9, 3.925215619841011*^9}, {
   3.925215722506998*^9, 3.925215745225569*^9}, {3.925215819098463*^9, 
   3.9252158336009064`*^9}, {3.925215906400108*^9, 3.925215931539669*^9}, {
   3.925215966250246*^9, 3.925216022079239*^9}, {3.925216180452858*^9, 
   3.925216251239977*^9}, {3.9252164957674427`*^9, 3.925216516636545*^9}, {
   3.92522055553246*^9, 3.925220562587256*^9}, {3.9252206559443817`*^9, 
   3.925220665468195*^9}, {3.925220788211867*^9, 3.925220804388109*^9}, {
   3.9252208946227474`*^9, 3.925220908461561*^9}, {3.9252209505956936`*^9, 
   3.9252209680020695`*^9}, {3.925221080775116*^9, 3.925221081651625*^9}, {
   3.925221130003488*^9, 3.925221523249338*^9}, {3.925221595615719*^9, 
   3.925221739945143*^9}, {3.925221791232016*^9, 3.9252217953991146`*^9}, {
   3.925221825479727*^9, 3.925221825627716*^9}, {3.925221857414416*^9, 
   3.925221889183731*^9}, {3.925221930605477*^9, 3.925222019202532*^9}, {
   3.9252220904033966`*^9, 3.925222099999613*^9}, {3.925222191193409*^9, 
   3.9252221990103593`*^9}, {3.9252222533805447`*^9, 
   3.9252222891969185`*^9}, {3.925222362579973*^9, 3.9252223744714317`*^9}, {
   3.9252225754530983`*^9, 3.925222582401367*^9}, {3.925222633946026*^9, 
   3.925222637068369*^9}, {3.9252227363026257`*^9, 3.925222768299113*^9}, {
   3.925222850663166*^9, 3.925222865085203*^9}, {3.925222923378597*^9, 
   3.925222945968784*^9}, 3.92522297954402*^9, {3.9252230172598934`*^9, 
   3.925223024487322*^9}, {3.9252232607277*^9, 3.9252232626735516`*^9}, {
   3.925223293871023*^9, 3.9252233023309*^9}, {3.925223436209923*^9, 
   3.925223442416756*^9}, {3.9252235332376423`*^9, 3.925223534334614*^9}, {
   3.925223594635212*^9, 3.925223648647976*^9}, 3.9252236803234787`*^9, {
   3.925223715678335*^9, 3.9252237398484936`*^9}, {3.925223794812252*^9, 
   3.925223884174391*^9}, {3.925223941339758*^9, 3.925224045164931*^9}, {
   3.925224078085715*^9, 3.925224088498963*^9}, {3.925224362169915*^9, 
   3.925224371404917*^9}, {3.9252244056026497`*^9, 3.925224414582258*^9}, {
   3.9252715532228985`*^9, 3.9252716195512505`*^9}, {3.925271652552904*^9, 
   3.9252717305986195`*^9}, {3.925271850939495*^9, 3.92527187983193*^9}, {
   3.925272025447309*^9, 3.925272112520231*^9}, {3.9252722204060764`*^9, 
   3.925272514776109*^9}, {3.9252726021264114`*^9, 3.925272606136711*^9}, {
   3.925272725956993*^9, 3.925272845287478*^9}, {3.925273030833231*^9, 
   3.925273032003702*^9}, {3.925273092919681*^9, 3.9252731570739193`*^9}, {
   3.92527318756954*^9, 3.9252732404272804`*^9}, {3.9252732738174057`*^9, 
   3.925273291708214*^9}, {3.9252733429397984`*^9, 3.925273515634117*^9}, {
   3.925273653673979*^9, 3.925273814598064*^9}, {3.9252738599981976`*^9, 
   3.925273889027519*^9}, {3.925274222309866*^9, 3.925274223389364*^9}, {
   3.9252743755189342`*^9, 3.925274440954407*^9}, {3.925274541762766*^9, 
   3.925274542399391*^9}, {3.9252745968182507`*^9, 3.925274599028807*^9}, {
   3.9252746416595554`*^9, 3.9252747293286667`*^9}, {3.925274873613893*^9, 
   3.9252750068277187`*^9}, {3.925275061521787*^9, 3.925275063667677*^9}, {
   3.9252751042776623`*^9, 3.925275261622394*^9}, {3.925275303708544*^9, 
   3.92527531606586*^9}, {3.9252753628209*^9, 3.9252754192183323`*^9}, {
   3.9252758310700397`*^9, 3.925276017433801*^9}, {3.925276099468986*^9, 
   3.925276103623495*^9}, {3.925276169136196*^9, 3.925276203083877*^9}, {
   3.9252762411458206`*^9, 3.925276245169449*^9}, {3.925276326748226*^9, 
   3.925276342567301*^9}, {3.925276389891361*^9, 3.9252763980566463`*^9}, {
   3.9252764991094437`*^9, 3.925276502666649*^9}, {3.925276539939445*^9, 
   3.925276553168722*^9}, {3.925276613226585*^9, 3.925276630898157*^9}, {
   3.925276676474554*^9, 3.925276685790655*^9}, {3.925277064008852*^9, 
   3.925277146098572*^9}, {3.925277179319582*^9, 3.925277233166033*^9}, {
   3.925277317003023*^9, 3.925277357532791*^9}, {3.925277481332974*^9, 
   3.9252775121333275`*^9}, {3.92527866245462*^9, 3.925278859309357*^9}, {
   3.925278890168436*^9, 3.92527889427453*^9}, {3.9252789325249863`*^9, 
   3.925278964462446*^9}, {3.92527905973983*^9, 3.9252790697468967`*^9}, {
   3.925279172241581*^9, 3.9252792010030193`*^9}, {3.9252792332978783`*^9, 
   3.9252792702898064`*^9}, {3.925279322831648*^9, 3.925279338829218*^9}, {
   3.925279384561348*^9, 3.925279449700481*^9}, {3.92553203656332*^9, 
   3.9255320476663084`*^9}, 3.925534471420407*^9, 3.9255345869388256`*^9, {
   3.925540845404249*^9, 3.9255408626171856`*^9}, {3.9255515341892223`*^9, 
   3.925551534813835*^9}, {3.925551578504595*^9, 3.925551579934559*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"518b8b44-17ea-9642-9b5f-3af30fd78840"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"sl", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", "->", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ",", 
     RowBox[{"\[Theta]", "->", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        FractionBox["z", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}], "+", 
           RowBox[{"z", "^", "2"}]}], "]"}]], ",", 
        FractionBox[
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}]}], "]"}], 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}], "+", 
           RowBox[{"z", "^", "2"}]}], "]"}]]}], "]"}]}], ",", 
     RowBox[{"\[Phi]", "->", 
      RowBox[{"ArcTan", "[", 
       RowBox[{
        FractionBox["x", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}]}], "]"}]], ",", 
        FractionBox["y", 
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"x", "^", "2"}], "+", 
           RowBox[{"y", "^", "2"}]}], "]"}]]}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0", "=", 
   RowBox[{"l", "-", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Alpha]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Tau]", "]"}], "*", "\[Epsilon]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"y0", "=", 
   RowBox[{"a", "+", 
    RowBox[{
     RowBox[{"Sin", "[", "\[Alpha]", "]"}], "*", 
     RowBox[{"Sin", "[", "\[Tau]", "]"}], "*", "\[Epsilon]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0", "=", 
   RowBox[{"\[Epsilon]", "*", 
    RowBox[{"Cos", "[", "\[Tau]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"initial", "[", "\[Epsilon]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}], " ", "/.", 
       "sl"}], " ", "/.", 
      RowBox[{"x", "->", "x0"}]}], "/.", 
     RowBox[{"y", "->", "y0"}]}], "/.", 
    RowBox[{"z", "->", "z0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"initial", "[", "0", "]"}], "/.", 
       RowBox[{"l", "->", "5"}]}], "/.", 
      RowBox[{"\[Alpha]", "->", "1"}]}], "/.", 
     RowBox[{"\[Tau]", "->", "2"}]}], "/.", 
    RowBox[{"a", "->", 
     FractionBox[
      RowBox[{"-", "1"}], "5"]}]}], "/.", 
   RowBox[{"\[Epsilon]", "->", "1"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "[", 
    RowBox[{"\[Alpha]0_", ",", "\[Tau]0_"}], "]"}], ":=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Lagrangeeqs", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"Lagrangeeqs", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"Lagrangeeqs", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "==", "0"}], ",", 
         RowBox[{
          RowBox[{"r", "[", "0", "]"}], "==", 
          RowBox[{
           RowBox[{"initial", "[", "0", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "0", "]"}], "==", 
          RowBox[{
           RowBox[{"initial", "[", "0", "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "==", 
          RowBox[{
           RowBox[{"initial", "[", "0", "]"}], "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"r", "'"}], "[", "0", "]"}], "==", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"initial", "[", "0", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "0", "]"}], "==", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"initial", "[", "0", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}]}], 
         ",", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "'"}], "[", "0", "]"}], "==", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"initial", "[", "0", "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "\[Epsilon]"}], "]"}]}]}], 
        "}"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"l", "->", "5"}], ",", 
         RowBox[{"a", "->", 
          RowBox[{
           RowBox[{"-", "1"}], "/", "5"}]}], ",", 
         RowBox[{"\[Alpha]", "->", "\[Alpha]0"}], ",", 
         RowBox[{"\[Tau]", "->", "\[Tau]0"}], ",", 
         RowBox[{"\[Epsilon]", "->", "1"}]}], "}"}]}], "//", "Evaluate"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"r", "[", "s", "]"}], ",", 
       RowBox[{"\[Theta]", "[", "s", "]"}], ",", 
       RowBox[{"\[Phi]", "[", "s", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "1000"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"soluzione", "=", 
  RowBox[{"sol", "[", 
   RowBox[{"2", ",", 
    RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsol", "=", 
   RowBox[{
    RowBox[{"r", "[", "s", "]"}], "/.", 
    RowBox[{"soluzione", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rsol", "/.", 
   RowBox[{"s", "->", "1"}]}], " ", "//", "Timing"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", 
   RowBox[{"rsol", ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "0", ",", "1000"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.925284625989559*^9, 3.925284627392472*^9}, {
   3.925284722763933*^9, 3.925284724275454*^9}, {3.9252851121560326`*^9, 
   3.925285223020508*^9}, {3.925531179601782*^9, 3.925531456146147*^9}, {
   3.925531524013691*^9, 3.9255316840940266`*^9}, {3.925531894056027*^9, 
   3.925531895664643*^9}, {3.925531994817936*^9, 3.925532007153702*^9}, {
   3.9255320527070913`*^9, 3.925532080800984*^9}, {3.925532131461136*^9, 
   3.9255323496112804`*^9}, {3.925532535665283*^9, 3.925532563716391*^9}, {
   3.9255326090856743`*^9, 3.925532650219944*^9}, {3.9255326954912453`*^9, 
   3.925532701180294*^9}, {3.9255327785940056`*^9, 3.925532791761215*^9}, {
   3.925532903653686*^9, 3.925532917633781*^9}, {3.925533050990988*^9, 
   3.9255330693089886`*^9}, {3.925533109456005*^9, 3.92553317239999*^9}, {
   3.9255332038693542`*^9, 3.925533249872504*^9}, {3.92553332979101*^9, 
   3.925533420407997*^9}, {3.925533524328241*^9, 3.925533544864973*^9}, {
   3.925533580482624*^9, 3.9255335958058834`*^9}, 3.9255336589141216`*^9, {
   3.9255337590443087`*^9, 3.9255337591449633`*^9}, {3.925533812503432*^9, 
   3.925533837910601*^9}, {3.925534162469862*^9, 3.9255341671558537`*^9}, {
   3.925534229854471*^9, 3.925534231819021*^9}, {3.925534338489599*^9, 
   3.925534344867407*^9}, {3.925534399694451*^9, 3.925534400103945*^9}, {
   3.925534433572737*^9, 3.925534436726174*^9}, {3.9255348675849304`*^9, 
   3.925534917311014*^9}, {3.925534965770729*^9, 3.925535140241949*^9}, {
   3.9255351772654552`*^9, 3.925535342462511*^9}, {3.92553737981546*^9, 
   3.9255373811126347`*^9}, {3.9255403280509224`*^9, 3.925540354550886*^9}, {
   3.925540711566408*^9, 3.925540714392685*^9}, {3.925550164805769*^9, 
   3.925550164988764*^9}, {3.925551667260868*^9, 3.925551694450392*^9}, 
   3.925553733660412*^9, {3.925554492916353*^9, 3.925554496017786*^9}, {
   3.9255546654658585`*^9, 3.925554666271761*^9}, 3.925557001233412*^9, {
   3.925558179994383*^9, 3.9255581813625107`*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"6c7435e7-5608-9b40-87d9-20c9b82624d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"fix", "=", 
   RowBox[{
    RowBox[{"InterpolatingFunction", "[", 
     RowBox[{"a_", ",", "b___"}], "]"}], ":>", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"s", ">", 
       RowBox[{"a", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", "0", ",", 
      RowBox[{"InterpolatingFunction", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"rsol2", "[", "s_", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"r", "[", "s", "]"}], "/.", 
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "*", 
            RowBox[{"i", "/", "160"}]}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", "fix"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "40"}], ",", "40", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]sol2", "[", "s_", "]"}], "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Phi]", "[", "s", "]"}], "/.", 
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{
           RowBox[{"\[Pi]", "*", 
            RowBox[{"i", "/", "160"}]}], ",", 
           RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "/.", "fix"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "40"}], ",", "40", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"y2", "[", "s_", "]"}], "=", 
   RowBox[{
    RowBox[{"rsol2", "[", "s", "]"}], "*", 
    RowBox[{"Sin", "[", 
     RowBox[{"\[Phi]sol2", "[", "s", "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"x2", "[", "s_", "]"}], "=", 
    RowBox[{
     RowBox[{"rsol2", "[", "s", "]"}], "*", 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Phi]sol2", "[", "s", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p", "=", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"ParametricPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"x2", "[", "s", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"y2", "[", "s", "]"}], "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"s", ",", "0", ",", "100"}], "}"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"Thickness", "[", "0.002", "]"}], ",", 
           RowBox[{"{", "Purple", "}"}]}], "]"}]}], ",", 
        RowBox[{"PlotLabel", "->", "\"\<Geodesic trajectory\>\""}], ",", 
        RowBox[{"AxesLabel", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<x\>\"", ",", "\"\<y\>\""}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "81", ",", "1"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{"p", ",", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{"Thick", ",", 
      RowBox[{"Circle", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        FractionBox["1", "200"]}], "]"}]}], "}"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.9255353732294846`*^9, 3.9255353855917625`*^9}, {
  3.9255357808952103`*^9, 3.9255359026148605`*^9}, {3.9255359368901024`*^9, 
  3.925535944439884*^9}, {3.9255360214356823`*^9, 3.9255360262642536`*^9}, {
  3.9255407431625385`*^9, 3.92554077717111*^9}, {3.9255517032231026`*^9, 
  3.9255517043196697`*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"2f1dfff5-a85d-5b41-964d-36cfdd55bf17"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dim", "=", "256"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"solutions", "=", 
     RowBox[{"Quiet", "[", 
      RowBox[{"ParallelTable", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"sol", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"\[Pi]", "/", "16"}], "*", 
            FractionBox[
             RowBox[{"i", "-", 
              RowBox[{"dim", "/", "2"}]}], "dim"]}], ",", 
           RowBox[{
            RowBox[{"\[Pi]", "/", "2"}], "-", 
            RowBox[{
             RowBox[{"\[Pi]", "/", "16"}], "*", 
             FractionBox[
              RowBox[{"j", "-", 
               RowBox[{"dim", "/", "2"}]}], "dim"]}]}]}], "]"}], "/.", 
         "fix"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "dim", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "dim", ",", "1"}], "}"}]}], "]"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"asymptoticXY", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{"(", " ", 
        RowBox[{
         RowBox[{"rinf", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"r", "[", "s", "]"}], "/.", " ", 
            RowBox[{"solutions", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "/.", " ", 
           RowBox[{"s", "->", "100"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"rinf", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\[Pi]", "-", 
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"\[Phi]", "[", "s", "]"}], ",", 
                  RowBox[{"2", "\[Pi]"}]}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"\[Pi]", "/", "2"}], "-", 
                RowBox[{"\[Theta]", "[", "s", "]"}]}]}], "}"}], "/.", 
             RowBox[{"solutions", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "/.", " ", 
            RowBox[{"s", "\[Rule]", "1000"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}]}], ")"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "dim", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim", ",", "1"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xy2XY", "=", 
     RowBox[{"ParallelTable", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"asymptoticXY", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], "*", 
         RowBox[{"dim", "/", 
          RowBox[{"(", 
           RowBox[{"\[Pi]", "/", "16"}], ")"}]}]}], "+", 
        RowBox[{"dim", "/", "2"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XY", "=", 
     RowBox[{"Round", "[", "xy2XY", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.9255482761658325`*^9, 3.925548276927016*^9}, {
   3.9255501808383007`*^9, 3.925550216278162*^9}, 3.9255503960085735`*^9, {
   3.925550486446209*^9, 3.92555049094672*^9}, {3.925551937262377*^9, 
   3.925552012638218*^9}, {3.925552173605234*^9, 3.925552174181747*^9}, {
   3.925553030264595*^9, 3.925553030908689*^9}, 3.925553641739521*^9, {
   3.9255542610828285`*^9, 3.925554263248087*^9}, {3.925555663160225*^9, 
   3.9255556646809425`*^9}, {3.925555715618124*^9, 3.925555718228531*^9}, {
   3.9255560306629047`*^9, 3.925556031159389*^9}, {3.9255578432655888`*^9, 
   3.9255578467737885`*^9}, {3.925557953622351*^9, 3.925557959374817*^9}, {
   3.9255581680548344`*^9, 3.92555822872698*^9}, {3.925559119979223*^9, 
   3.9255591202104187`*^9}, {3.9255671447610016`*^9, 
   3.9255671452640057`*^9}, {3.925619441756338*^9, 3.925619442725916*^9}, {
   3.92562059917758*^9, 3.9256206234690723`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"c60f1732-dc51-bd47-9ed1-263594a31ad8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"im", "=", 
   RowBox[{
   "Import", "[", "\"\<C:\\\\Users\\\\Gianmarco\\\\Downloads\\\\im.jpeg\>\"", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"img", "=", 
  RowBox[{"ImageResize", "[", 
   RowBox[{"im", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"dim", "=", "256"}], ",", "dim"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.9255450905663757`*^9, 3.925545142598974*^9}, {
   3.9255451770338507`*^9, 3.92554520595689*^9}, {3.925545280145729*^9, 
   3.9255452892760925`*^9}, {3.925549069243292*^9, 3.925549078471445*^9}, {
   3.925551907450438*^9, 3.925551908057137*^9}, {3.925553035843521*^9, 
   3.925553036596269*^9}, {3.925553687444271*^9, 3.9255536881799145`*^9}, 
   3.9255582410753956`*^9, {3.925558602258154*^9, 3.925558602573723*^9}, {
   3.925558700615169*^9, 3.925558700733816*^9}, {3.925559104010151*^9, 
   3.9255591043562374`*^9}, {3.925567114061949*^9, 3.925567120527313*^9}, {
   3.925619446808769*^9, 3.9256194472815533`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"f76bc4e8-941b-794e-a650-9b7fef89b949"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"imd", "=", 
   RowBox[{"ImageData", "[", "img", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}], "\[GreaterEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "\[GreaterEqual]", "1"}], "&&", 
        RowBox[{
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}], "\[LessEqual]", "dim"}], "&&", 
        RowBox[{
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}], "\[LessEqual]", "dim"}]}], ",", 
       RowBox[{"imd", "\[LeftDoubleBracket]", 
        RowBox[{
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "1"}], 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{"XY", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j", ",", "1", ",", "2"}], 
          "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "dim"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "dim"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"isListOfThreeNumbersQ", "[", "element_", "]"}], ":=", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"element", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"_", "?", "NumberQ"}], ",", 
       RowBox[{"_", "?", "NumberQ"}], ",", 
       RowBox[{"_", "?", "NumberQ"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"processeddata", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"isListOfThreeNumbersQ", "[", "#", "]"}], ",", "#", ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], "&"}], ",", 
     "data", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Image", "[", "processeddata", "]"}]}], "Input",
 CellChangeTimes->{{3.925556192268083*^9, 3.92555619575461*^9}, {
  3.925556414218963*^9, 3.925556414658306*^9}, {3.925556641546255*^9, 
  3.925556650812407*^9}, {3.925558034301847*^9, 3.925558069293733*^9}, {
  3.925558399625061*^9, 3.925558432542248*^9}, {3.925558515543417*^9, 
  3.925558554826254*^9}, {3.925558599708292*^9, 3.9255586227325115`*^9}, {
  3.925558656682167*^9, 3.925558688056593*^9}, {3.9255587374644585`*^9, 
  3.925558790570381*^9}, {3.925559230695938*^9, 3.9255592326806755`*^9}, {
  3.9255593691352997`*^9, 3.9255593696272793`*^9}, {3.925567001959772*^9, 
  3.925567016224959*^9}, {3.9255670512481136`*^9, 3.925567084589617*^9}, {
  3.925621575407137*^9, 
  3.9256215851110516`*^9}},ExpressionUUID->"d1054d88-a9ed-714f-8a7e-\
6bfcb592fd2f"]
},
WindowSize->{1152, 579.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
Magnification:>1. Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"53637152-58b0-9b43-9ff1-2324971cd2a0"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 1261, 31, 67, "Input",ExpressionUUID->"663eb267-6783-4340-88fa-a9de4ef266e3"],
Cell[1822, 53, 16648, 401, 493, "Input",ExpressionUUID->"518b8b44-17ea-9642-9b5f-3af30fd78840"],
Cell[18473, 456, 8255, 215, 373, "Input",ExpressionUUID->"6c7435e7-5608-9b40-87d9-20c9b82624d7"],
Cell[26731, 673, 4317, 126, 217, "Input",ExpressionUUID->"2f1dfff5-a85d-5b41-964d-36cfdd55bf17"],
Cell[31051, 801, 4296, 107, 163, "Input",ExpressionUUID->"c60f1732-dc51-bd47-9ed1-263594a31ad8"],
Cell[35350, 910, 1085, 21, 48, "Input",ExpressionUUID->"f76bc4e8-941b-794e-a650-9b7fef89b949"],
Cell[36438, 933, 3239, 77, 143, "Input",ExpressionUUID->"d1054d88-a9ed-714f-8a7e-6bfcb592fd2f"]
}
]
*)

